<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Web-API | HonjayChang</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/photo.ico">
    <meta name="description" content="厚积而薄发">
    
    <link rel="preload" href="/assets/css/0.styles.101e93c3.css" as="style"><link rel="preload" href="/assets/js/app.8db34c63.js" as="script"><link rel="preload" href="/assets/js/2.983698d7.js" as="script"><link rel="preload" href="/assets/js/37.aaea4be9.js" as="script"><link rel="prefetch" href="/assets/js/10.53f50f72.js"><link rel="prefetch" href="/assets/js/11.14ae67e3.js"><link rel="prefetch" href="/assets/js/12.8bd1e098.js"><link rel="prefetch" href="/assets/js/13.81e2b1b5.js"><link rel="prefetch" href="/assets/js/14.89bf0b9b.js"><link rel="prefetch" href="/assets/js/15.c965b4da.js"><link rel="prefetch" href="/assets/js/16.6253e22c.js"><link rel="prefetch" href="/assets/js/17.f2d1d7ed.js"><link rel="prefetch" href="/assets/js/18.d194ed84.js"><link rel="prefetch" href="/assets/js/19.9dfc0424.js"><link rel="prefetch" href="/assets/js/20.38e0a8e2.js"><link rel="prefetch" href="/assets/js/21.29b30efb.js"><link rel="prefetch" href="/assets/js/22.70e339a1.js"><link rel="prefetch" href="/assets/js/23.481c7338.js"><link rel="prefetch" href="/assets/js/24.47652bca.js"><link rel="prefetch" href="/assets/js/25.66e7da71.js"><link rel="prefetch" href="/assets/js/26.162bb288.js"><link rel="prefetch" href="/assets/js/27.5a4ab791.js"><link rel="prefetch" href="/assets/js/28.e7411d81.js"><link rel="prefetch" href="/assets/js/29.9144167b.js"><link rel="prefetch" href="/assets/js/3.363d4551.js"><link rel="prefetch" href="/assets/js/30.1265b18a.js"><link rel="prefetch" href="/assets/js/31.c8454f4e.js"><link rel="prefetch" href="/assets/js/32.5e3e87b4.js"><link rel="prefetch" href="/assets/js/33.8f3137a0.js"><link rel="prefetch" href="/assets/js/34.3b003f35.js"><link rel="prefetch" href="/assets/js/35.840eb4e9.js"><link rel="prefetch" href="/assets/js/36.df15f5f0.js"><link rel="prefetch" href="/assets/js/38.352ad4cb.js"><link rel="prefetch" href="/assets/js/39.e72d78d1.js"><link rel="prefetch" href="/assets/js/4.d38cbe0d.js"><link rel="prefetch" href="/assets/js/40.dff4d77e.js"><link rel="prefetch" href="/assets/js/5.b570c556.js"><link rel="prefetch" href="/assets/js/6.c9f44ce5.js"><link rel="prefetch" href="/assets/js/7.5da1919b.js"><link rel="prefetch" href="/assets/js/8.c43efb22.js"><link rel="prefetch" href="/assets/js/9.d8640715.js">
    <link rel="stylesheet" href="/assets/css/0.styles.101e93c3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/photo.jpg" alt="HonjayChang" class="logo"> <span class="site-name can-hide">HonjayChang</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/FE/" class="nav-link">
  FE
</a></div><div class="nav-item"><a href="/interview/" class="nav-link router-link-active">
  INTE
</a></div><div class="nav-item"><a href="/dev/" class="nav-link">
  DEV
</a></div><div class="nav-item"><a href="/DS/" class="nav-link">
  DS
</a></div><div class="nav-item"><a href="https://honjaychang.github.io/VuePress/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Link
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/FE/" class="nav-link">
  FE
</a></div><div class="nav-item"><a href="/interview/" class="nav-link router-link-active">
  INTE
</a></div><div class="nav-item"><a href="/dev/" class="nav-link">
  DEV
</a></div><div class="nav-item"><a href="/DS/" class="nav-link">
  DS
</a></div><div class="nav-item"><a href="https://honjaychang.github.io/VuePress/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Link
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/interview/" aria-current="page" class="sidebar-link">HTML</a></li><li><a href="/interview/CSS.html" class="sidebar-link">CSS</a></li><li><a href="/interview/JS.html" class="sidebar-link">JavaScript</a></li><li><a href="/interview/Web-API.html" aria-current="page" class="active sidebar-link">Web-API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/Web-API.html#内存泄露、垃圾回收机制" class="sidebar-link">内存泄露、垃圾回收机制</a></li><li class="sidebar-sub-header"><a href="/interview/Web-API.html#dom" class="sidebar-link">DOM</a></li><li class="sidebar-sub-header"><a href="/interview/Web-API.html#bom" class="sidebar-link">BOM</a></li><li class="sidebar-sub-header"><a href="/interview/Web-API.html#事件" class="sidebar-link">事件</a></li><li class="sidebar-sub-header"><a href="/interview/Web-API.html#ajax" class="sidebar-link">AJAX</a></li><li class="sidebar-sub-header"><a href="/interview/Web-API.html#跨域" class="sidebar-link">跨域</a></li><li class="sidebar-sub-header"><a href="/interview/Web-API.html#存储" class="sidebar-link">存储</a></li></ul></li><li><a href="/interview/HTTP-Browser.html" class="sidebar-link">HTTP-Browser</a></li><li><a href="/interview/network.html" class="sidebar-link">计网</a></li><li><a href="/interview/hand.html" class="sidebar-link">各种手写</a></li><li><a href="/interview/quize.html" class="sidebar-link">作用域和自由变量</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="web-api"><a href="#web-api" class="header-anchor">#</a> Web-API</h1> <ul><li><p>JS基础知识 --&gt; 规定语法 --&gt; ECMA 262标准</p></li> <li><p>JS Web API --&gt; 网页操作的API --&gt; W3C标准</p></li></ul> <h2 id="内存泄露、垃圾回收机制"><a href="#内存泄露、垃圾回收机制" class="header-anchor">#</a> 内存泄露、垃圾回收机制</h2> <h5 id="什么是内存泄漏"><a href="#什么是内存泄漏" class="header-anchor">#</a> 什么是内存泄漏?</h5> <ul><li>内存泄露是指不再用的内存没有被及时释放出来，导致该段内存无法被使用就是内存泄漏。</li></ul> <h5 id="为什么会导致内存泄漏"><a href="#为什么会导致内存泄漏" class="header-anchor">#</a> 为什么会导致内存泄漏?</h5> <ul><li>内存泄漏指我们无法在通过<code>js</code>访问某个对象，而垃圾回收机制却认为该对象还在被引用，因此垃圾回收机制不会释放该对象，导致该块内存永远无法释放，积少成多，系统会越来越卡以至于崩溃。</li></ul> <h5 id="垃圾回收机制的策略"><a href="#垃圾回收机制的策略" class="header-anchor">#</a> 垃圾回收机制的策略</h5> <ul><li>标记清除法
<ul><li>垃圾回收器获取根并<strong>标记</strong>它们。</li> <li>然后它访问并“标记”所有来自它们的引用。</li> <li>然后它访问标记的对象并标记它们的引用。所有被访问的对象都被记住，以便以后不再访问同一个对象两次。</li> <li>以此类推，直到有未访问的引用(可以从根访问)为止。</li> <li>除标记的对象外，所有对象都被删除。</li></ul></li> <li>引用计数法
<ul><li>当声明一个变量并给该变量赋值一个引用类型的值时候，该值的计数+1</li> <li>当该值赋值给另一个变量的时候，该计数+1</li> <li>当该值被其他值取代的时候，该计数-1</li> <li>当计数变为0的时候，说明无法访问该值了，垃圾回收机制清除该对象</li> <li>但如果出现循环引用 引用计数就会出现问题 无法回收</li></ul></li></ul> <p><code>Ref:</code></p> <ul><li><a href="https://segmentfault.com/a/1190000018605776" target="_blank" rel="noopener noreferrer">前端面试：谈谈 JS 垃圾回收机制<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="dom"><a href="#dom" class="header-anchor">#</a> DOM</h2> <ul><li><code>Document Object Model:</code>文档对象模型</li></ul> <h4 id="dom本质"><a href="#dom本质" class="header-anchor">#</a> DOM本质</h4> <ul><li>DOM 是哪种数据结构 ==&gt; 树 DOM树</li></ul> <h4 id="dom节点操作"><a href="#dom节点操作" class="header-anchor">#</a> DOM节点操作</h4> <ul><li>DOM操作的常用 API
<ul><li>DOM 节点操作</li> <li>DOM 结构操作</li> <li><code>Attribute property</code></li></ul></li></ul> <h5 id="获取dom节点"><a href="#获取dom节点" class="header-anchor">#</a> 获取DOM节点</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> div1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'div1'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> divList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span> <span class="token comment">// div集合</span>
<span class="token keyword">const</span> cla <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'red-border'</span><span class="token punctuation">)</span> <span class="token comment">// 集合</span>
<span class="token keyword">const</span> div1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#div1'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> pList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span> <span class="token comment">// 集合</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="attribute"><a href="#attribute" class="header-anchor">#</a> <code>attribute</code></h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code>对<span class="token constant">DOM</span>结构节点属性
p<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'data-name'</span><span class="token punctuation">,</span> <span class="token string">'pNode'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'data-name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

p<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'style'</span><span class="token punctuation">,</span> <span class="token string">'font-size:20px'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'style'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="property"><a href="#property" class="header-anchor">#</a> <code>property</code></h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 通过js属性 property 形式</span>
<span class="token keyword">const</span> p <span class="token operator">=</span> pList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
p<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'pink'</span>
p<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'ppp'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>nodeName<span class="token punctuation">)</span> <span class="token comment">// P nodeName 为大写</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>nodeType<span class="token punctuation">)</span> <span class="token comment">// 1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="property-和-attribute区别"><a href="#property-和-attribute区别" class="header-anchor">#</a> <code>property</code> 和 <code>attribute</code>区别</h5> <ul><li><code>property:</code> <ul><li>DOM 元素在 <code>JavaScript</code> 中作为对象拥有的属性</li> <li>修改对象属性，不会体现到<code>html</code>结构中</li></ul></li> <li><code>attribute:</code> <ul><li>DOM 元素在文档中作为 <code>HTML</code> 标签拥有的属性</li> <li>修改<code>html</code>属性，会改变<code>html</code>结构</li></ul></li> <li>两者都有可能引起DOM 重新渲染</li> <li>尽量使用<code>property</code></li> <li>数据绑定：
<ul><li><code>attributes</code>的数据会同步到<code>property</code>上，然而<code>property</code>的更改不会改变<code>attribute</code></li></ul></li></ul> <h5 id="获取class"><a href="#获取class" class="header-anchor">#</a> 获取<code>class</code></h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#box'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dom<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dom<span class="token punctuation">.</span>className<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="dom结构操作"><a href="#dom结构操作" class="header-anchor">#</a> DOM结构操作</h5> <ul><li><p>新增/插入节点</p></li> <li><p>获取子元素列表，获取父元素</p></li> <li><p>删除子元素</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 新建节点</span>
<span class="token keyword">const</span> p1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
p1<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'123'</span>

<span class="token comment">// 插入节点</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span>

<span class="token comment">// 移动节点</span>
<span class="token keyword">const</span> p2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'p2'</span><span class="token punctuation">)</span>
div1<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span>

<span class="token comment">// 获取父元素</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>parentNode<span class="token punctuation">)</span>


<span class="token comment">// 获取子元素列表</span>
<span class="token keyword">const</span> divChildNodes <span class="token operator">=</span> container<span class="token punctuation">.</span>childNodes
<span class="token keyword">const</span> divChildNodesP <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span>childNodes<span class="token punctuation">)</span>
											<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> num<span class="token punctuation">.</span>nodeType <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">// 将节点列表 NodeList 转化为数组 Array 使用filter过滤节点类型为1 的元素</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>divChildNodesP<span class="token punctuation">)</span>

<span class="token comment">// 删除子元素</span>
<span class="token keyword">const</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'container'</span><span class="token punctuation">)</span>
<span class="token comment">// const p = document.getElementsByTagName('p')[0]</span>
<span class="token keyword">const</span> child <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span>childNodes<span class="token punctuation">)</span>
							<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> num<span class="token punctuation">.</span>nodeType <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span>
container<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>child<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h5 id="dom性能"><a href="#dom性能" class="header-anchor">#</a> DOM性能</h5> <ul><li>DOM操作非常“昂贵”，避免频繁的DOM操作</li></ul> <h6 id="如何减少dom操作"><a href="#如何减少dom操作" class="header-anchor">#</a> 如何减少DOM操作？</h6> <ul><li>对DOM查询做缓存</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 不缓存 DOM 查询结果</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span>document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 每次循环都会计算 length ，频繁进行 DOM 查询</span>
<span class="token punctuation">}</span>

<span class="token comment">// 缓存 DOM 查询结果</span>
<span class="token keyword">const</span> len <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 缓存 length 只进行一次DOM 查询</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li>将多次DOM操作合并为一次性操作</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span>

<span class="token comment">// 创建一个文档片段，此时还没有插入到 DOM 树中</span>
<span class="token keyword">const</span> frag <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 执行插入</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> li <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span>
  li<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'List item '</span> <span class="token operator">+</span> i
  frag<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>li<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 都完成之后，再插入到DOM树中</span>
list<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>frag<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>一次性插入多个DOM 节点，考虑性能:  <code>const frag = document.createDocumentFragment()</code></li></ul> <h5 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h5> <ul><li>DOM 本质</li> <li>DOM 节点操作</li> <li>DOM 结构操作</li> <li>DOM 性能</li></ul> <h2 id="bom"><a href="#bom" class="header-anchor">#</a> BOM</h2> <ul><li><code>Browser Object Model</code> 浏览器对象模型</li></ul> <h4 id="bom-api"><a href="#bom-api" class="header-anchor">#</a> BOM-API</h4> <ul><li><code>navigator</code></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> ua <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent
<span class="token keyword">const</span> isChrome <span class="token operator">=</span> ua<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'Chrome'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ua<span class="token punctuation">,</span> isChrome<span class="token punctuation">)</span>
<span class="token comment">// Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Mobile Safari/537.36 true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>screen</code></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>screen<span class="token punctuation">.</span>width<span class="token punctuation">,</span> screen<span class="token punctuation">.</span>height<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><code>location</code></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>hostname<span class="token punctuation">,</span> location<span class="token punctuation">.</span>port<span class="token punctuation">)</span> <span class="token comment">// 域名 端口</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>href<span class="token punctuation">,</span> location<span class="token punctuation">.</span>pathname<span class="token punctuation">)</span> <span class="token comment">// 链接 路径</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>protocol<span class="token punctuation">)</span> <span class="token comment">// 协议</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>search<span class="token punctuation">)</span> <span class="token comment">// ？+ 后 搜索的内容</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">)</span> <span class="token comment">// #后 hash值</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>history</code></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>history<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
history<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="uri-编码"><a href="#uri-编码" class="header-anchor">#</a> URI 编码</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">encodeURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 将元字符和语义字符之外的字符，都进行转义</span>
<span class="token function">encodeURIComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 会转码除了语义字符之外的所有字符</span>

<span class="token function">encodeURI</span><span class="token punctuation">(</span><span class="token string">'http://www.example.com/q=春节'</span><span class="token punctuation">)</span>
<span class="token comment">// &quot;http://www.example.com/q=%E6%98%A5%E8%8A%82&quot;</span>
<span class="token function">encodeURIComponent</span><span class="token punctuation">(</span><span class="token string">'http://www.example.com/q=春节'</span><span class="token punctuation">)</span>
<span class="token comment">// &quot;http%3A%2F%2Fwww.example.com%2Fq%3D%E6%98%A5%E8%8A%82&quot;</span>


<span class="token function">decodeURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">decodeURIComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li><p><code>URI</code> =&gt; 统一资源标识符</p></li> <li><p><code>URL</code> =&gt; <code>Uniform Resource Locator</code>，统一资源定位符</p></li> <li><p><code>URI</code> 用字符串标识某一互联网资源，而 <code>URL</code> 表示资源的地点 =&gt; 可见 <code>URL</code> 是 <code>URI</code> 的子集</p></li></ul> <h5 id="如何识别浏览器的类型"><a href="#如何识别浏览器的类型" class="header-anchor">#</a> 如何识别浏览器的类型</h5> <ul><li><code>navigator.userAgent.includes('Chrome')</code></li></ul> <h5 id="分析拆解url各个部分"><a href="#分析拆解url各个部分" class="header-anchor">#</a> 分析拆解url各个部分</h5> <ul><li><code>location.xxx</code></li></ul> <h2 id="事件"><a href="#事件" class="header-anchor">#</a> 事件</h2> <h4 id="一些概念"><a href="#一些概念" class="header-anchor">#</a> 一些概念</h4> <h5 id="事件绑定方式"><a href="#事件绑定方式" class="header-anchor">#</a> 事件绑定方式</h5> <ul><li>dom 元素绑定</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span> onclick<span class="token operator">=</span><span class="token string">&quot;alert('hello'')&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>on 绑定
<ul><li>同一个dom元素，on只能绑定一个同类型事件，后者会覆盖前者</li> <li>不同类型的事件可以绑定多个</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 解绑</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>click <span class="token operator">=</span> <span class="token keyword">null</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><p><code>attachEvent</code></p> <ul><li>同一个dom元素上事件执行顺序：随机</li></ul></li> <li><p><code>addEventListener('', cb, boolean)</code></p> <ul><li>同一个dom元素上事件执行顺序：按照事件的绑定顺序先后执行</li> <li><code>bool</code>: 默认<code>false</code> 冒泡阶段  /   <code>true</code> 捕获阶段</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 绑定</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> bodyClick<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 解绑</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> bodyClick<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

e <span class="token operator">=</span> e <span class="token operator">||</span> window<span class="token punctuation">.</span>event
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="三个阶段"><a href="#三个阶段" class="header-anchor">#</a> 三个阶段</h5> <ul><li>事件捕获： 当鼠标点击或者触发dom事件时（被触发dom事件的这个元素被叫作事件源），浏览器会从根节点到事件源（由外到内）进行事件传播。</li> <li>目标阶段：事件到达目标元素</li> <li>事件冒泡：与事件捕获相反，事件源到根节点（由内到外）进行事件传播。</li></ul> <h5 id="阻止默认行为"><a href="#阻止默认行为" class="header-anchor">#</a> 阻止默认行为</h5> <ul><li><code>event.stopPropagation()</code>：阻止事件冒泡</li> <li><code>event.preventDefault()</code>：阻止事件默认行为</li></ul> <h4 id="事件绑定"><a href="#事件绑定" class="header-anchor">#</a> 事件绑定</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>事件绑定<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button<span class="token operator">&gt;</span>button<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>

<span class="token comment">// 事件绑定</span>
<span class="token keyword">const</span> <span class="token function-variable function">bindEvent</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">elem<span class="token punctuation">,</span> type<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  elem<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> cb<span class="token punctuation">)</span>
<span class="token punctuation">}</span>


<span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token function">bindEvent</span><span class="token punctuation">(</span>btn<span class="token punctuation">,</span> <span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// console.log(event.target) // 获取触发的元素</span>
  event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 阻止事件的默认行为</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Click'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="事件冒泡"><a href="#事件冒泡" class="header-anchor">#</a> 事件冒泡</h4> <ul><li>事件冒泡：触出发元素根据DOM结构从内至外进行事件响应</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>事件冒泡<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;div1&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p id<span class="token operator">=</span><span class="token string">&quot;p1&quot;</span><span class="token operator">&gt;</span>激活<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p id<span class="token operator">=</span><span class="token string">&quot;p2&quot;</span><span class="token operator">&gt;</span>取消<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p id<span class="token operator">=</span><span class="token string">&quot;p3&quot;</span><span class="token operator">&gt;</span>取消<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p id<span class="token operator">=</span><span class="token string">&quot;p4&quot;</span><span class="token operator">&gt;</span>取消<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;div2&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p id<span class="token operator">=</span><span class="token string">&quot;p5&quot;</span><span class="token operator">&gt;</span>取消<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>p id<span class="token operator">=</span><span class="token string">&quot;p6&quot;</span><span class="token operator">&gt;</span>取消<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token comment">// 事件冒泡 顺着DOM结构向上冒泡</span>
<span class="token keyword">const</span> p1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'p1'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> body <span class="token operator">=</span> document<span class="token punctuation">.</span>body
<span class="token function">bindEvent</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> <span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 阻止事件向上冒泡行为 即阻止 弹出 取消 而只执行 弹出 激活</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'激活'</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">bindEvent</span><span class="token punctuation">(</span>body<span class="token punctuation">,</span> <span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'取消'</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h4 id="事件代理-委托"><a href="#事件代理-委托" class="header-anchor">#</a> 事件代理（委托）</h4> <ul><li>事件委托就是利用事件冒泡，只指定一个事件处理程序，就可以管理某一类型的所有事件。</li></ul> <h5 id="事件委托的原理"><a href="#事件委托的原理" class="header-anchor">#</a> 事件委托的原理</h5> <ul><li>根据冒泡机制，子元素触发的事件会冒泡到父元素，触发相同类型的事件。那么我把想要绑定的事件挂载到父元素上，并且判断一下触发的元素是不是我想要触发的，就实现了事件代理。</li> <li>不是每个子节点单独设置事件监听器，而是事件监听器设置在其父节点上，然后利用冒泡原理影响设置每个子节点。</li></ul> <h5 id="事件委托的作用"><a href="#事件委托的作用" class="header-anchor">#</a> 事件委托的作用</h5> <ul><li>我们只操作了一次DOM，提高了程序的性能。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>事件代理<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;div3&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;https://www.google.com&quot;</span><span class="token operator">&gt;</span>a1<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;#&quot;</span><span class="token operator">&gt;</span>a2<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;#&quot;</span><span class="token operator">&gt;</span>a3<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;#&quot;</span><span class="token operator">&gt;</span>a4<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">&quot;btn1&quot;</span><span class="token operator">&gt;</span>点击增加a标签<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>

<span class="token comment">// 事件代理</span>
<span class="token keyword">const</span> div3 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'div3'</span><span class="token punctuation">)</span>
<span class="token function">bindEvent</span><span class="token punctuation">(</span>div3<span class="token punctuation">,</span> <span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 阻止a链接默认跳转</span>
  <span class="token keyword">const</span> target <span class="token operator">=</span> e<span class="token punctuation">.</span>target
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> target<span class="token punctuation">.</span>nodeName<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>nodeName <span class="token operator">===</span> <span class="token string">'A'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><ul><li><p>代码简洁</p></li> <li><p>减少浏览器内存占用</p></li> <li><p>但是，不要滥用（在瀑布流 或者结构复杂的时候比较方便</p></li></ul> <p>题目</p> <h5 id="编写一个通用的事件监听函数"><a href="#编写一个通用的事件监听函数" class="header-anchor">#</a> 编写一个通用的事件监听函数</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">bindEvent</span><span class="token punctuation">(</span><span class="token parameter">elem<span class="token punctuation">,</span> type<span class="token punctuation">,</span> selector<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cb <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cb <span class="token operator">=</span> selector
    selector <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span>
  elem<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> target <span class="token operator">=</span> event<span class="token punctuation">.</span>target
    <span class="token keyword">if</span> <span class="token punctuation">(</span>selector<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 代理绑定</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> event<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 普通绑定</span>
      <span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> event<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 箭头函数的this 会绑定到全局  所以要改为普通的function</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h5 id="描述事件冒泡的流程"><a href="#描述事件冒泡的流程" class="header-anchor">#</a> 描述事件冒泡的流程</h5> <ul><li>基于DOM 树形结构</li> <li>事件会顺着触发元素向上冒泡</li> <li>应用场景：代理</li></ul> <h5 id="无限下拉的图片列表-如何监听每个图片的点击"><a href="#无限下拉的图片列表-如何监听每个图片的点击" class="header-anchor">#</a> 无限下拉的图片列表，如何监听每个图片的点击？</h5> <ul><li>事件代理</li> <li>用 <code>e.target</code> 获取触发元素</li> <li>用 <code>matches</code> 来判断是否是触发元素</li></ul> <h2 id="ajax"><a href="#ajax" class="header-anchor">#</a> <code>AJAX</code></h2> <ul><li><code>Asynchronous Javascript and XML</code></li> <li>异步<code>JavaScrpt</code>和<code>xml</code>，用于在Web页面中实现异步数据交互，实现页面局部刷新</li></ul> <p>优点：</p> <ul><li>异步请求响应快，用户体验好（使用异步的方式与服务器通信，不打断用户的操作）</li> <li>页面无刷新、数据局部更新（在不刷新整个页面的情况下维持与服务器通信）</li> <li>按需取数据，减少了冗余请求和服务器的负担。前端和后端负载均衡（将一些后端的工作交给前端，减少服务器与宽度的负担）</li></ul> <p>缺点：</p> <ul><li>对搜索引擎不友好</li> <li><code>ajax</code>不支持返回上一次请求内容 不支持浏览器<code>back</code>按钮
<ul><li><code>location.hash</code>来解决<code>Ajax</code>过程中导致的浏览器前进后退按键失效</li></ul></li> <li>可能造成请求数的增加 跨域问题限制</li></ul> <h4 id="xmlhttprequest"><a href="#xmlhttprequest" class="header-anchor">#</a> <code>XMLHttpRequest</code></h4> <ul><li>通过<code>XMLHttpRequest</code>向服务器发送异步请求，获得服务器返回的数据，利用<code>js</code>更新页面</li></ul> <h5 id="实现get"><a href="#实现get" class="header-anchor">#</a> 实现Get</h5> <ul><li>创建<code>XMLHttpRequest</code>对象，也就是创建一个异步调用对象</li> <li>创建一个新的HTTP请求，并指定该HTTP请求的方法、URL及验证信息</li> <li>设置响应HTTP请求状态变化的函数</li> <li>发送HTTP请求</li> <li>获取异步调用返回的数据</li> <li>使用<code>JavaScript</code>和<code>DOM</code>实现局部刷新</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// XMLHttpRequest get 请求</span>
<span class="token keyword">let</span> xhr 

<span class="token keyword">if</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>XMLHttpRequest<span class="token punctuation">)</span><span class="token punctuation">{</span>
  xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
  xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActiveXObject</span><span class="token punctuation">(</span><span class="token string">'Microsoft.XMLHTTP'</span><span class="token punctuation">)</span><span class="token comment">//兼容ie5/6</span>
<span class="token punctuation">}</span>
<span class="token comment">// 0 </span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'data.json'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token comment">// 是否异步 false // 1</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 2 3 4</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'some error happened'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h5 id="post"><a href="#post" class="header-anchor">#</a> Post</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// XMLHttpRequest post 请求</span>
<span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'/login'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// 是否异步 true --&gt; 异步</span>
<span class="token comment">/* xhr.setRequestHeader('Content-type','application/x-www-form-urlencoded')
 * xhr.send('status=1&amp;flag=1')
 * POST请求方式必须设置这个请求头信息，目的是请求体中的数据转换为键值对，这样后端接收到status=1&amp;flag=1这样的数据才知道是这是一个POST方式传来的数据
 */</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'some error happened'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> postData <span class="token operator">=</span> <span class="token punctuation">{</span>
  username<span class="token operator">:</span> <span class="token string">'zhangsan'</span><span class="token punctuation">,</span>
  password<span class="token operator">:</span> <span class="token string">'xxx'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>postData<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="状态码-readystate-status"><a href="#状态码-readystate-status" class="header-anchor">#</a> 状态码 <code>readyState</code> <code>status</code></h4> <h5 id="xhr-readystate"><a href="#xhr-readystate" class="header-anchor">#</a> <code>xhr.readyState</code></h5> <ul><li>0 -（请求未初始化）还没有调用<code>send()</code>方法</li> <li>1 -（服务器连接已建立）已调用<code>send()</code>方法，正在发送请求</li> <li>2 -（请求已接收） <code>send()</code>方法执行完成，已经接收到全部响应内容</li> <li>3 -（请求处理中）正在解析响应内容</li> <li>4 -（请求已完成，且响应已就绪）响应内容解析完成，可以在客户端调用</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'UNSENT'</span><span class="token punctuation">,</span> xhr<span class="token punctuation">.</span>readyState<span class="token punctuation">)</span> <span class="token comment">// readyState 为 0</span>

xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'/api'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'OPENED'</span><span class="token punctuation">,</span> xhr<span class="token punctuation">.</span>readyState<span class="token punctuation">)</span> <span class="token comment">// readyState 为 1</span>

xhr<span class="token punctuation">.</span><span class="token function-variable function">onprogress</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'LOADING'</span><span class="token punctuation">,</span> xhr<span class="token punctuation">.</span>readyState<span class="token punctuation">)</span> <span class="token comment">// readyState 为 3</span>
<span class="token punctuation">}</span>

xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'DONE'</span><span class="token punctuation">,</span> xhr<span class="token punctuation">.</span>readyState<span class="token punctuation">)</span> <span class="token comment">// readyState 为 4</span>
<span class="token punctuation">}</span>

xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h5 id="xhr-status"><a href="#xhr-status" class="header-anchor">#</a> <code>xhr.status</code></h5> <ul><li>2xx - 表示成功处理请求，如 200</li> <li>3xx - 需要重定向，浏览器直接跳转，如 301 302 304</li> <li>4xx - 客户端请求错误，如 404 403</li> <li>5xx - 服务器端错误</li></ul> <h5 id="fetch-和-ajax-区别"><a href="#fetch-和-ajax-区别" class="header-anchor">#</a> <code>fetch</code> 和 <code>ajax</code> 区别</h5> <ul><li><p><code>fetch</code> 直接返回 <code>promise</code>; 当请求错误时不会<code>reject</code>， 只有在网络故障时才会 <code>reject</code>。 默认情况下不接收<code>cookie</code>, 需要配置 <code>credentials</code> 选项。配合 <code>service worker</code>可以实现对请求的缓存等。</p></li> <li><p><code>fetch</code>: 是对<code>ajax</code>做了一层<code>promise</code>的封装,但是对于请求的拦截,响应的拦截还是需要手动代码实现,同时现在的谷歌浏览器已经支持<code>fetch</code>这个<code>api</code>了</p></li> <li><p><code>ajax</code> 基于 <code>XMLHttpRequest</code>分别执行成功和失败的回调。</p></li></ul> <h5 id="说说防止重复发送-ajax-请求的方法有哪些"><a href="#说说防止重复发送-ajax-请求的方法有哪些" class="header-anchor">#</a> 说说防止重复发送 ajax 请求的方法有哪些？</h5> <ul><li><p>按钮置灰 =&gt; 无按钮咋办</p></li> <li><p>防抖法：在一段时间内重复请求，则取消本次请求 =&gt; timer设置多少？</p></li> <li><p>节流法：在一段时间内只能请求一次，下次请求必须在前一次请求完成后</p></li> <li><p>请求拦截和请求取消</p></li></ul> <h2 id="跨域"><a href="#跨域" class="header-anchor">#</a> 跨域</h2> <h4 id="同源策略"><a href="#同源策略" class="header-anchor">#</a> 同源策略</h4> <ul><li><code>ajax</code>请求时，浏览器要求当前网页和 <code>server</code> 必须同源（安全）</li> <li>同源：协议、域名、端口，三者必须一致
<ul><li>子域名也不同源</li></ul></li></ul> <p>如下所示就是不同源，且协议、域名、端口都不同源</p> <div class="language-basic line-numbers-mode"><pre class="language-basic"><code>前端 <span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>a.<span class="token keyword">com</span><span class="token punctuation">:</span><span class="token number">8080</span><span class="token operator">/</span><span class="token punctuation">;</span> 
server <span class="token punctuation">:</span> https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>b.<span class="token keyword">com</span><span class="token operator">/</span>api<span class="token operator">/</span>xxx 

三者都不同源<span class="token punctuation">:</span> http VS https		a VS b		<span class="token number">8080</span> VS <span class="token number">443</span>

同源策略仅限于浏览器 在浏览器中生效 
服务端并没有，如：爬虫、攻击……
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>加载 <strong><code>图片 css js</code></strong> 可无视同源策略</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>img src<span class="token operator">=</span>跨域的图片地址<span class="token operator">/</span><span class="token operator">&gt;</span>  <span class="token comment">//但是图片可能出现防盗链 这是由服务器端限制的</span>
  
<span class="token operator">&lt;</span>link href<span class="token operator">=</span>跨域的css地址<span class="token operator">/</span><span class="token operator">&gt;</span>
  
<span class="token operator">&lt;</span>script src<span class="token operator">=</span>跨域的js地址<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>img <span class="token operator">/</span><span class="token operator">&gt;</span>可用于统计打点，可使用第三方统计服务

<span class="token operator">&lt;</span>link<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>可使用<span class="token constant">CDN</span>， <span class="token constant">CDN</span> 一般都是外域

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>可实现 <span class="token constant">JSONP</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>跨域
<ul><li>所有的跨域请求，都必须经过 <code>server</code> 端 允许和配合</li> <li>未经 <code>server</code> 端允许就实现跨域，说明浏览器有漏洞，危险信号</li></ul></li></ul> <h4 id="跨域解决方案"><a href="#跨域解决方案" class="header-anchor">#</a> 跨域解决方案</h4> <h5 id="反向代理"><a href="#反向代理" class="header-anchor">#</a> 反向代理</h5> <ul><li>在<code>vue</code>中使用<code>proxy</code>进行跨域的原理是：将域名发送给本地的服务器（启动vue项目的服务,<code>loclahost:8080</code>），再由本地的服务器去请求真正的服务器。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>  <span class="token comment">//配置跨域</span>
      <span class="token string">'/api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            target<span class="token operator">:</span> <span class="token string">'xxx.com'</span><span class="token punctuation">,</span>  <span class="token comment">// 后台接口地址</span>
            changOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">// 允许跨域</span>
            pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 重写路径</span>
              <span class="token string">'^/api'</span><span class="token operator">:</span> <span class="token string">'/'</span> 
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
      
<span class="token comment">// axios.defaults.baseURL = '/api'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><code>Ref</code></p> <ul><li><a href="https://juejin.cn/post/6844904033874886663" target="_blank" rel="noopener noreferrer">[VUE] vue配置反向代理解决跨域<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h5 id="cors-服务端支持"><a href="#cors-服务端支持" class="header-anchor">#</a> <code>CORS（服务端支持）</code></h5> <ul><li><code>CORS(Cross-Origin Resourse Sharing)</code>，跨域资源共享</li> <li>相比 <code>JSONP</code> 只能发<code>GET</code>请求，<code>CORS</code> 允许任何类型的请求</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// CORS  服务器端设置 http header</span>

<span class="token comment">// 第二个参数填写允许跨域的域名，不建议直接写*</span>
response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Origin'</span><span class="token punctuation">,</span> <span class="token string">'http://127.0.0.1:5500'</span><span class="token punctuation">)</span>
response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Headers'</span><span class="token punctuation">,</span> <span class="token string">'X-Requested-With'</span><span class="token punctuation">)</span>
response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span>
  <span class="token string">'Access-Control-Allow-Methods'</span><span class="token punctuation">,</span>
  <span class="token string">'PUT,POST,GET,DELETE,OPTIONS'</span>
<span class="token punctuation">)</span>

<span class="token comment">// 接收跨域的cookie</span>
response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Credentials'</span><span class="token punctuation">,</span> <span class="token string">'true'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h5 id="jsonp"><a href="#jsonp" class="header-anchor">#</a> <code>JSONP</code></h5> <ul><li><code>JSON with Padding =&gt; &lt;script&gt;</code> <code>AJAX =&gt; XML</code></li> <li><code>JSONP</code> 缺点：只限于<code>get</code>请求  但是兼容性好</li> <li>封装<code>jsonp</code>的核心就在于我们监听<code>window</code>上的<code>jsonp</code>进行回调时的名称</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;http://api.foo.com?callback=bar&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>告诉服务器，客户端的回调函数: <code>bar</code></li> <li>服务器收到请求后，拼接一个字符串，将 <code>JSON</code> 数据放在函数名里面，作为字符串返回<code>bar({...})</code></li> <li>客户端会将服务器返回的字符串，作为代码解析，因为浏览器认为，这是<code>&lt;script&gt;</code>标签请求的脚本内容。这时，客户端只要定义了<code>bar()</code>函数，就能在该函数体内，拿到服务器返回的 <code>JSON</code> 数据。</li></ul> <p>下面代码通过动态添加<code>&lt;script&gt;</code>元素，向服务器<code>example.com</code>发出请求</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">addScriptTag</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token string">'text/javascript'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">addScriptTag</span><span class="token punctuation">(</span><span class="token string">'http://example.com/ip?callback=foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Your public IP address is: '</span> <span class="token operator">+</span> data<span class="token punctuation">.</span>ip<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li><code>jQuery</code> 实现<code>jsonp</code></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
  $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">'http://127.0.0.1:5500/JS/jsonp.js'</span><span class="token punctuation">,</span>
  dataType<span class="token operator">:</span> <span class="token string">'jsonp'</span><span class="token punctuation">,</span>
  jsonpCallback<span class="token operator">:</span> <span class="token string">'callback'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h5 id="websocket"><a href="#websocket" class="header-anchor">#</a> <code>WebSocket</code></h5> <ul><li><code>websocket</code> 是HTML5的一个新协议，它允许服务端向客户端传递信息，实现浏览器和客户端双工通信。</li> <li>使用<code>ws://</code>和<code>wss://</code>（加密）作为协议前缀 该协议不实行同源政策，只要服务器支持，就可以通过它进行跨源通信</li> <li><code>websocket</code> 弥补了HTTP不支持长连接的特点</li></ul> <p>关于<code>webSocket</code></p> <ul><li><code>HTTP</code> 通信只能由客户端发起 如果服务器有连续的状态变化，客户端只能使用“轮询”的方法获取新的信息 效率很低 浪费资源（不停连接 或 连接始终打开</li> <li><code>WebSocket</code> 服务器可以主动向客户端推送信息，客户端也可以主动向服务器发送信息</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">'wss://echo.websocket.org'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ws<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Connection open ...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Hello WebSockets!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

ws<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Received Message: '</span> <span class="token operator">+</span> evt<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  ws<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

ws<span class="token punctuation">.</span><span class="token function-variable function">onclose</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Connection closed.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
ws<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ul><li><code>webSocket.readyState</code> 返回实例对象的当前状态
<ul><li><code>CONNECTING</code>：值为0，表示正在连接</li> <li><code>OPEN</code>：值为1，表示连接成功，可以通信了</li> <li><code>CLOSING</code>：值为2，表示连接正在关闭</li> <li><code>CLOSED</code>：值为3，表示连接已经关闭，或者打开连接失败</li></ul></li></ul> <p>心跳机制</p> <ul><li>每隔一段时间会向服务器发送一个数据包，告诉服务器自己还活着，同时客户端会确认服务器端是否还活着，如果还活着的话，就会回传一个数据包给客户端来确定服务器端也还活着，否则的话，有可能是网络断开连接了，需要重连。</li></ul> <p>实现思路</p> <ul><li>每隔一段固定的时间，向服务器端发送一个 <code>ping</code> 数据，如果在正常的情况下，服务器会返回一个 <code>pong</code> 给客户端，如果客户端通过 <code>onmessage</code> 事件能监听到的话，说明请求正常，这里我们使用了一个定时器，每隔3秒的情况下，如果是网络断开的情况下，在指定的时间内服务器端并没有返回心跳响应消息，因此服务器端断开了，因此这个时候我们使用 <code>ws.close</code> 关闭连接，在一段时间后可以通过  <code>onclose</code> 事件监听到。因此在 <code>onclose</code> 事件内，我们可以调用 <code>reconnect</code> 事件进行重连操作。</li></ul> <h5 id="window-postmessage"><a href="#window-postmessage" class="header-anchor">#</a> <code>window.postMessage</code></h5> <ul><li><code>window.postMessage(data, origin, source)</code></li></ul> <h2 id="存储"><a href="#存储" class="header-anchor">#</a> 存储</h2> <h4 id="cookie-localstorage-sessionstorage-区别"><a href="#cookie-localstorage-sessionstorage-区别" class="header-anchor">#</a> <code>cookie localStorage sessionStorage</code> 区别</h4> <ul><li>容量</li> <li>API易用性</li> <li>是否跟随<code>http</code>请求发送出去</li></ul> <h5 id="比较cookie、localstorage、sessionstorage"><a href="#比较cookie、localstorage、sessionstorage" class="header-anchor">#</a> 比较<code>cookie、localStorage、sessionStorage</code></h5> <p>相同点：都是存储数据，存储在web端，并且都是同源</p> <p>不同点：</p> <ul><li><code>cookie</code> 只有4K  并且每一次http请求都会带上<code>cookie</code> ，增加请求数据量，浪费带宽</li> <li><code>sessionStorage</code>和<code>localStorage</code>直接存储在本地，请求不会携带，并且容量比<code>cookie</code>要大的多（5M？）</li> <li>生命周期：
<ul><li><code>sessionStorage</code> 是临时会话，当前窗口被关闭的时候就清除掉</li> <li><code>localStorage</code> 永久存在，除非手动删除或用代码删除，一般用<code>localStorage</code> 会更多一些</li> <li><code>cookie</code> 有过期时间</li></ul></li> <li><code>cookie</code> 和<code>localStorage</code>都可以支持多窗口共享(同源策略)，而<code>session</code>不支持多窗口共享。但是都支持a链接跳转的新窗口</li></ul> <h5 id="api"><a href="#api" class="header-anchor">#</a> API</h5> <ul><li><code>cookie:</code> 可用<code>document.cookie = '...'</code>来修改，但一次只能赋值一个且同一个key会覆盖，不同的key是追加的过程。</li> <li><code>localStorage sessionStorage:</code> API简易使用<code>setItem getItem</code></li></ul> <h4 id="方法详解"><a href="#方法详解" class="header-anchor">#</a> 方法详解</h4> <ul><li><p><code>setItem(key, value)</code>设置存储内容</p></li> <li><p><code>getItem(key)</code>读取存储内容</p></li> <li><p><code>removeItem(key)</code>删除键值为<code>key</code>的存储内容</p></li> <li><p><code>clear()</code>清空所有存储内容</p></li> <li><p><code>key(n)</code> 以索引值来获取键名</p></li> <li><p><code>length</code>存储的数据的个数</p></li></ul> <h4 id="关于cookie"><a href="#关于cookie" class="header-anchor">#</a> 关于<code>cookie</code></h4> <ul><li><code>cookie</code>的编码方式：<code>encodeURI()</code></li></ul> <h4 id="cookie有哪些字段可以设置"><a href="#cookie有哪些字段可以设置" class="header-anchor">#</a> cookie有哪些字段可以设置</h4> <ul><li><a href="https://www.kancloud.cn/kancloud/http-cookies-explained/48333" target="_blank" rel="noopener noreferrer">HTTP cookies 详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>Set-Cookie: value[; expires=date][; domain=domain][; path=path][; secure]</code></li> <li><code>Set-Cookie: name=Nicholas; expires=Sat, 02 May 2021 23:38:25 GMT domain=nczonline.net; path=/blog; secure</code> <ul><li><code>secure</code>：只允许在https下传输</li> <li><code>Max-age</code>: cookie生成后失效的秒数</li> <li><code>expire</code>: cookie的最长有效时间，若不设置则cookie生命期与会话期相同</li></ul></li> <li><code>document.cookie=&quot;name=Nicholas;domain=nczonline.net;path=/&quot;;</code></li> <li>通过给<code>cookie</code>设置<code>http-only</code>属性，使得不能被客户端更改访问，无法通过<code>js</code>脚本读取到该<code>cookie</code>的信息。但还是能通过 <code>Application</code>中手动修改<code>cookie</code>，所以只是在一定程度上可以防止<code>xss</code>攻击，并不是绝对的安全。</li> <li><code>cookie</code>数据有路径<code>path</code>的概念，可以限制当前<code>cookie</code>只属于某个路径下</li></ul> <h4 id="cookie-与-session"><a href="#cookie-与-session" class="header-anchor">#</a> cookie 与 session</h4> <ul><li><code>cookie</code>数据存放在客户的浏览器上，<code>session</code>数据放在服务器上</li> <li><code>cookie</code>在<code>http</code>下是明文传输的，不是很安全。别人可以分析存放在本地的<code>cookie</code>并进行<code>cookie</code>欺骗
考虑到安全应当使用<code>session</code>。</li> <li><code>session</code>的运行依赖<code>sessionId</code>，而<code>sessionId</code>又保存在<code>cookie</code>中，所以如果禁用的<code>cookie</code>，<code>session</code>也是不能用的，不过硬要用也可以，可以把<code>sessionId</code>保存在<code>url</code>中</li> <li><code>session</code>会在一定时间内保存在服务器上。当访问增多，会比较占用你服务器的性能，考虑到减轻服务器性能方面，应当使用<code>cookie</code></li> <li>单个<code>cookie</code>保存的数据不能超过4K，很多浏览器都限制一个站点最多保存20个<code>cookie</code></li></ul> <h4 id="localstorage存满了怎么办"><a href="#localstorage存满了怎么办" class="header-anchor">#</a> localstorage存满了怎么办？</h4> <ul><li><p>划分域名：各域名下的存储空间由各业务组统一规划使用</p></li> <li><p>跨页面传数据：考虑单页应用、优先采用url传输数据</p></li> <li><p>最后兜底方案：清掉别人的存储</p></li> <li><p><code>cookie</code> 的跨域问题</p> <ul><li>存在，<code>cookie</code>是跟域名绑定的；可以通过二级域名来解决跨域问题</li></ul></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Honjaychang/Honjaychang.github.io/issues/new#/edit/master/interview/Web-API.md" target="_blank" rel="noopener noreferrer">纠错/留言/交流</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/12/2021, 10:48:37 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/interview/JS.html" class="prev">
        JavaScript
      </a></span> <span class="next"><a href="/interview/HTTP-Browser.html">
        HTTP-Browser
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8db34c63.js" defer></script><script src="/assets/js/2.983698d7.js" defer></script><script src="/assets/js/37.aaea4be9.js" defer></script>
  </body>
</html>
