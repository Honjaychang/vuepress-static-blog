(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{390:function(t,s,a){"use strict";a.r(s);var e=a(42),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"http-browser"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http-browser"}},[t._v("#")]),t._v(" HTTP-Browser")]),t._v(" "),a("h2",{attrs:{id:"http状态码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http状态码"}},[t._v("#")]),t._v(" HTTP"),a("a",{attrs:{href:"HTTPs://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status"}},[t._v("状态码")])]),t._v(" "),a("h4",{attrs:{id:"分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分类"}},[t._v("#")]),t._v(" 分类")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("分类")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("分类描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("1**")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("信息响应，服务器收到请求，需要请求者继续执行操作")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("2**")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("成功响应，操作被成功接收并处理")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("3**")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("重定向，需要进一步的操作以完成请求")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("4**")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("客户端错误，请求包含语法错误或无法完成请求")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("5**")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("服务器错误，服务器在处理请求的过程中发生了错误")])])])]),t._v(" "),a("h4",{attrs:{id:"常见状态码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见状态码"}},[t._v("#")]),t._v(" 常见状态码")]),t._v(" "),a("ul",[a("li",[t._v("200 - 请求成功")]),t._v(" "),a("li",[t._v("204 - 请求处理成功，但没有资源可返回")]),t._v(" "),a("li",[t._v("206 - 对资源的某一部分进行请求")]),t._v(" "),a("li",[t._v("301 - 资源被永久转移到其它URL(永久重定向到新的location)")]),t._v(" "),a("li",[t._v("302 - 资源临时移动(临时重定向)")]),t._v(" "),a("li",[t._v("304 - 所请求的资源未修改")]),t._v(" "),a("li",[t._v("307 - 临时重定向")]),t._v(" "),a("li",[t._v("400 - 请求报文存在语法错误")]),t._v(" "),a("li",[t._v("403 - 没有权限")]),t._v(" "),a("li",[t._v("404 - 请求的资源不存在")]),t._v(" "),a("li",[t._v("500 - 内部服务器错误")]),t._v(" "),a("li",[t._v("502 - 网关错误")]),t._v(" "),a("li",[t._v("504 - 网关超时")])]),t._v(" "),a("h2",{attrs:{id:"http-method"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http-method"}},[t._v("#")]),t._v(" HTTP Method")]),t._v(" "),a("h4",{attrs:{id:"传统的-methods"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#传统的-methods"}},[t._v("#")]),t._v(" 传统的 methods")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("get")]),t._v(" 获取服务器的数据")]),t._v(" "),a("li",[a("code",[t._v("post")]),t._v(" 向服务器提交数据")])]),t._v(" "),a("h4",{attrs:{id:"现在的-methods"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#现在的-methods"}},[t._v("#")]),t._v(" 现在的 methods")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("get")]),t._v(" 获取数据")]),t._v(" "),a("li",[a("code",[t._v("post")]),t._v(" 新建数据")]),t._v(" "),a("li",[a("code",[t._v("patch/put")]),t._v(" 更新数据")]),t._v(" "),a("li",[a("code",[t._v("delete")]),t._v(" 删除数据")])]),t._v(" "),a("h4",{attrs:{id:"restful-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#restful-api"}},[t._v("#")]),t._v(" Restful API")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("传统API设计:把每个url当做一个功能")])]),t._v(" "),a("li",[a("p",[t._v("Restful API设计:一种新的API设计方法，把每个url当做一个唯一的资源")])]),t._v(" "),a("li",[a("p",[t._v("如何设计成一个资源？")]),t._v(" "),a("ul",[a("li",[t._v("尽量不用url参数")])]),t._v(" "),a("div",{staticClass:"language-basic line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-basic"}},[a("code",[t._v("传统API设计"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("api"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("list?pageIndex"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\nRestful API设计"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("api"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("list"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("ul",[a("li",[t._v("用method表示操作类型")])]),t._v(" "),a("div",{staticClass:"language-basic line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-basic"}},[a("code",[t._v("传统API设计"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \npost请求\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("api"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("create"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("blog\npost请求\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("api"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("update"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("blog?id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v("请求\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("api"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("blog?id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n\nRestful API设计"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \npost请求\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("api"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("blog\npatch请求\t "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("api"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("blog"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v("请求\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("api"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("blog"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])])])]),t._v(" "),a("h2",{attrs:{id:"get和post的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get和post的区别"}},[t._v("#")]),t._v(" Get和Post的区别？")]),t._v(" "),a("ul",[a("li",[t._v("缓存："),a("code",[t._v("get")]),t._v("请求的数据是可以缓存的；"),a("code",[t._v("post")]),t._v("是不可缓存的。")]),t._v(" "),a("li",[t._v("功能\n"),a("ul",[a("li",[a("code",[t._v("get")]),t._v("请求类似于查找的过程，用户获取数据，可以不用每次都与数据库连接，所以可以使用缓存。")]),t._v(" "),a("li",[a("code",[t._v("post")]),t._v("做的一般是修改和删除的工作，所以必须与数据库交互，所以不能使用缓存。")])])]),t._v(" "),a("li",[t._v("传参："),a("code",[t._v("get")]),t._v("传参，参数是在url中的；"),a("code",[t._v("post")]),t._v("传参，参数是在请求体中。")]),t._v(" "),a("li",[t._v("安全性："),a("code",[t._v("get")]),t._v("不安全，"),a("code",[t._v("post")]),t._v("较为安全："),a("code",[t._v("post")]),t._v("易于防止"),a("code",[t._v("CSRF")]),t._v("。")]),t._v(" "),a("li",[t._v("参数长度："),a("code",[t._v("get")]),t._v("参数长度有限，是较小的；"),a("code",[t._v("post")]),t._v("传参长度不受限制。")])]),t._v(" "),a("h4",{attrs:{id:"get请求传参长度的误区"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get请求传参长度的误区"}},[t._v("#")]),t._v(" get请求传参长度的误区")]),t._v(" "),a("p",[a("strong",[t._v("误区")]),t._v("：我们经常说get请求参数的大小存在限制，而post请求的参数大小是无限制的。")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("HTTP")]),t._v("协议未规定"),a("code",[t._v("GET")]),t._v("和"),a("code",[t._v("POST")]),t._v("的请求长度限制")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("GET")]),t._v("的最大长度显示是因为：浏览器和web服务器限制了URL的长度")])]),t._v(" "),a("li",[a("p",[t._v("不同的浏览器和WEB服务器，限制的最大长度不一样")])]),t._v(" "),a("li",[a("p",[t._v("要支持"),a("code",[t._v("IE")]),t._v("，则最大长度为"),a("code",[t._v("2083byte")]),t._v("，若只支持"),a("code",[t._v("Chrome")]),t._v("，则最大长度 "),a("code",[t._v("8182byte")])])])]),t._v(" "),a("h2",{attrs:{id:"http首部"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http首部"}},[t._v("#")]),t._v(" HTTP首部")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("HTTP")]),t._v(" 请求报文：请求方法、"),a("code",[t._v("URI")]),t._v("、"),a("code",[t._v("HTTP")]),t._v("版本、"),a("code",[t._v("HTTP")]),t._v("首部字段")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("HTTP")]),t._v(" 响应报文："),a("code",[t._v("HTTP")]),t._v("版本、状态码、"),a("code",[t._v("HTTP")]),t._v("首部字段")])])]),t._v(" "),a("h4",{attrs:{id:"http首部字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http首部字段"}},[t._v("#")]),t._v(" "),a("code",[t._v("HTTP")]),t._v("首部字段")]),t._v(" "),a("ul",[a("li",[t._v("首部字段名：字段值")])]),t._v(" "),a("h4",{attrs:{id:"通用首部字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通用首部字段"}},[t._v("#")]),t._v(" 通用首部字段")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Cache-Control")]),t._v(" ：能够控制缓存的行为")]),t._v(" "),a("li",[a("code",[t._v("Connection")]),t._v(" "),a("ul",[a("li",[t._v("控制不再转发给代理的首部字段")]),t._v(" "),a("li",[t._v("管理持久连接 "),a("code",[t._v("Connection: Keep-Alive / close")]),t._v("  一次TCP连接重复使用")])])]),t._v(" "),a("li",[a("code",[t._v("Date")]),t._v("：表明创建 HTTP 报文的日期和时间")]),t._v(" "),a("li",[a("code",[t._v("Warning")]),t._v("：会告知用户一些与缓存相关的问题的警告")])]),t._v(" "),a("h4",{attrs:{id:"请求首部字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#请求首部字段"}},[t._v("#")]),t._v(" 请求首部字段")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Accept")]),t._v("：告知服务器，用户代理能够处理的媒体类型及媒体类型的相对优先级\n"),a("ul",[a("li",[a("code",[t._v("Accept-Charset")]),t._v("：优先的字符集")]),t._v(" "),a("li",[a("code",[t._v("Accept-Encoding")]),t._v("：可接收的压缩算法 "),a("code",[t._v("gzip")])]),t._v(" "),a("li",[a("code",[t._v("Accept-Language")]),t._v("："),a("code",[t._v("zh-cn")])])])]),t._v(" "),a("li",[a("code",[t._v("Authorization")]),t._v("：Web 认证信息")]),t._v(" "),a("li",[a("code",[t._v("Host")]),t._v("：请求的域名是什么")]),t._v(" "),a("li",[a("code",[t._v("User-Agent")]),t._v("：浏览器信息")]),t._v(" "),a("li",[a("code",[t._v("If-Match If-Modified-Since If-None-Match If-Range")])]),t._v(" "),a("li",[a("code",[t._v("Cookie")])])]),t._v(" "),a("h4",{attrs:{id:"响应首部字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#响应首部字段"}},[t._v("#")]),t._v(" 响应首部字段")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("ETag")]),t._v("：资源的匹配信息")]),t._v(" "),a("li",[a("code",[t._v("Location")]),t._v("：提供重定向"),a("code",[t._v("url")])]),t._v(" "),a("li",[a("code",[t._v("Server")]),t._v("：HTTP服务器的安装信息")]),t._v(" "),a("li",[a("code",[t._v("Set-Cookie")])])]),t._v(" "),a("h4",{attrs:{id:"实体首部字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实体首部字段"}},[t._v("#")]),t._v(" 实体首部字段")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("包含在请求报文和响应报文中的实体部分所使用的首部，用于补充内容的更新时间等与实体相关的信息")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("Content-Type: text/html")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("Keep-Alive: timeout=15, max=100")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("Allow")]),t._v("：请求资源允许使用的方法")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("Content")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Content-Encoding")]),t._v("：返回数据的压缩算法，如 "),a("code",[t._v("gzip")])]),t._v(" "),a("li",[a("code",[t._v("Content-Language")])]),t._v(" "),a("li",[a("code",[t._v("Content-Length")])]),t._v(" "),a("li",[a("code",[t._v("Content-Type")]),t._v("：返回 / 发送数据的格式，如"),a("code",[t._v("application/json")])])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("Expires Last-Modified")])])])]),t._v(" "),a("h4",{attrs:{id:"缓存相关"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缓存相关"}},[t._v("#")]),t._v(" 缓存相关")]),t._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("Cache-Control\tExpires\nLast-Modified If-Modified-Since\nEtag\tIf-None-Match\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h2",{attrs:{id:"http-缓存策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http-缓存策略"}},[t._v("#")]),t._v(" HTTP 缓存策略")]),t._v(" "),a("h4",{attrs:{id:"浏览器的三级缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的三级缓存"}},[t._v("#")]),t._v(" 浏览器的三级缓存")]),t._v(" "),a("ul",[a("li",[t._v("内存 => 磁盘 => 网络请求")])]),t._v(" "),a("h4",{attrs:{id:"强制缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#强制缓存"}},[t._v("#")]),t._v(" 强制缓存")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("在过期时间内，未被主动清除 都不会请求服务器 而使用强制缓存 => 协商缓存")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("200 from disk cache")]),t._v(" "),a("code",[t._v("200 from memory cache")])])])]),t._v(" "),a("h5",{attrs:{id:"cache-control"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cache-control"}},[t._v("#")]),t._v(" "),a("code",[t._v("cache-control")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("max-age")]),t._v("：浏览器可以接收生存期不大于指定时间（秒）的响应")]),t._v(" "),a("li",[a("code",[t._v("no-cache")]),t._v("：不用强制缓存，让服务端缓存")]),t._v(" "),a("li",[a("code",[t._v("no-store")]),t._v("：不用强制缓存，也不让服务端缓存")]),t._v(" "),a("li",[a("code",[t._v("private")]),t._v("：允许终端用户")]),t._v(" "),a("li",[a("code",[t._v("public")]),t._v("：允许中间代理")])]),t._v(" "),a("h5",{attrs:{id:"expires"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#expires"}},[t._v("#")]),t._v(" "),a("code",[t._v("Expires")])]),t._v(" "),a("ul",[a("li",[t._v("同为控制缓存过期。如果 "),a("code",[t._v("cache-control")]),t._v(" 与 "),a("code",[t._v("expires")]),t._v(" 同时存在的话，"),a("code",[t._v("cache-control")]),t._v(" 的优先级高于"),a("code",[t._v("expires")])])]),t._v(" "),a("h4",{attrs:{id:"协商缓存-对比缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#协商缓存-对比缓存"}},[t._v("#")]),t._v(" 协商缓存（对比缓存）")]),t._v(" "),a("ul",[a("li",[t._v("浏览器和服务器协商，每次都需要和服务器通信")]),t._v(" "),a("li",[t._v("第一次请求时，服务器会返回资源和一个资源的缓存标识")]),t._v(" "),a("li",[t._v("第二次请求时，浏览器会先将缓存标识发给服务器  然后服务器对标识进行匹配\n"),a("ul",[a("li",[t._v("不匹配 => 资源有更新 => 服务器返回新资源和新的缓存标识")]),t._v(" "),a("li",[t._v("匹配 => 资源未更改 => 返回304状态码 读取本地浏览器缓存")])])])]),t._v(" "),a("h5",{attrs:{id:"last-modified"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#last-modified"}},[t._v("#")]),t._v(" "),a("code",[t._v("Last-Modified")])]),t._v(" "),a("ul",[a("li",[t._v("对应 "),a("code",[t._v("If-Modified-Since")])]),t._v(" "),a("li",[t._v("响应资源的最后修改时间 只能精确到秒级")])]),t._v(" "),a("h5",{attrs:{id:"etag"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#etag"}},[t._v("#")]),t._v(" "),a("code",[t._v("Etag")])]),t._v(" "),a("ul",[a("li",[t._v("对应 "),a("code",[t._v("If-None-Match")])]),t._v(" "),a("li",[a("code",[t._v("Etag")]),t._v("是服务器响应请求时，返回当前资源文件的一个唯一标识(类似指纹 由服务器生成)")]),t._v(" "),a("li",[t._v("同时存在 会优先使用 "),a("code",[t._v("Etag")])]),t._v(" "),a("li",[t._v("如果资源被重复生成，而内容不变，则"),a("code",[t._v("Etag")]),t._v("更精确")])]),t._v(" "),a("h5",{attrs:{id:"浏览器加载js文件有缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器加载js文件有缓存"}},[t._v("#")]),t._v(" 浏览器加载"),a("code",[t._v("JS")]),t._v("文件有缓存")]),t._v(" "),a("ul",[a("li",[t._v("浏览器加载js文件是根据路径加载，首先根据路径在缓存里查找")]),t._v(" "),a("li",[t._v("解决办法：打包时加一些哈希值 or 版本号")])]),t._v(" "),a("p",[a("code",[t._v("Ref")]),t._v("：")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://blog.csdn.net/i13738612458/article/details/80383390?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control&dist_request_id=&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control",target:"_blank",rel:"noopener noreferrer"}},[t._v("js 浏览器缓存机制"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/feiyu_may/article/details/88376945",target:"_blank",rel:"noopener noreferrer"}},[t._v("浏览器缓存带来的前端项目更新问题及解决方法"),a("OutboundLink")],1)])]),t._v(" "),a("h5",{attrs:{id:"刷新操作对缓存的影响"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#刷新操作对缓存的影响"}},[t._v("#")]),t._v(" 刷新操作对缓存的影响")]),t._v(" "),a("ul",[a("li",[t._v("正常操作:\n"),a("ul",[a("li",[t._v("地址栏输入"),a("code",[t._v("url")]),t._v("，跳转链接，前进后退等")]),t._v(" "),a("li",[t._v("强制缓存有效，协商缓存有效")])])]),t._v(" "),a("li",[t._v("手动刷新:\n"),a("ul",[a("li",[a("code",[t._v("F5")]),t._v("，点击刷新按钮，右击菜单刷新")]),t._v(" "),a("li",[t._v("强制缓存失效，协商缓存有效")])])]),t._v(" "),a("li",[t._v("强制刷新:\n"),a("ul",[a("li",[a("code",[t._v("ctrl + F5")])]),t._v(" "),a("li",[t._v("强制缓存失效，协商缓存失效")])])])]),t._v(" "),a("h2",{attrs:{id:"运行环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行环境"}},[t._v("#")]),t._v(" 运行环境")]),t._v(" "),a("h4",{attrs:{id:"网页加载过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网页加载过程"}},[t._v("#")]),t._v(" 网页加载过程")]),t._v(" "),a("h5",{attrs:{id:"渲染过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#渲染过程"}},[t._v("#")]),t._v(" 渲染过程")]),t._v(" "),a("ul",[a("li",[t._v("根据 "),a("code",[t._v("HTML")]),t._v(" 代码生成 "),a("code",[t._v("DOM Tree")])]),t._v(" "),a("li",[t._v("根据 "),a("code",[t._v("CSS")]),t._v(" 代码生成 "),a("code",[t._v("CSSOM")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("css")]),t._v(" 不会阻塞"),a("code",[t._v("DOM")]),t._v("树的解析")]),t._v(" "),a("li",[a("code",[t._v("css")]),t._v(" 加载会阻塞"),a("code",[t._v("DOM")]),t._v("树渲染")])])]),t._v(" "),a("li",[t._v("将 "),a("code",[t._v("DOM Tree")]),t._v(" 和 "),a("code",[t._v("CSSOM")]),t._v(" 整合形成 "),a("code",[t._v("Render Tree")])]),t._v(" "),a("li",[t._v("根据 "),a("code",[t._v("Render Tree")]),t._v(" 渲染页面")]),t._v(" "),a("li",[t._v("遇到  "),a("code",[t._v("<script>")]),t._v(" 则暂停渲染，优先加载并执行"),a("code",[t._v("JS")]),t._v("代码，完成再继续")]),t._v(" "),a("li",[t._v("直至把 "),a("code",[t._v("Render Tree")]),t._v(" 渲染完成")])]),t._v(" "),a("h5",{attrs:{id:"为什么要将-css-link-href-放在head中"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么要将-css-link-href-放在head中"}},[t._v("#")]),t._v(" 为什么要将 "),a("code",[t._v('CSS <link href="#">')]),t._v(" 放在head中")]),t._v(" "),a("ul",[a("li",[t._v("在"),a("code",[t._v("DOM")]),t._v("树生成前就将"),a("code",[t._v("CSS")]),t._v("规则加载完")]),t._v(" "),a("li",[t._v("在"),a("code",[t._v("DOM")]),t._v("生成完成后直接和所有的"),a("code",[t._v("CSS")]),t._v("规则整合 => 一步渲染完成 "),a("code",[t._v("Render Tree")])])]),t._v(" "),a("h5",{attrs:{id:"为何建议将js放在body最后"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为何建议将js放在body最后"}},[t._v("#")]),t._v(" 为何建议将"),a("code",[t._v("JS")]),t._v("放在"),a("code",[t._v("body")]),t._v("最后")]),t._v(" "),a("ul",[a("li",[t._v("不放在最后的话，"),a("code",[t._v("JS")]),t._v(" 代码会阻塞 "),a("code",[t._v("render tree")]),t._v(" 的渲染，可能会导致页面渲染时间比较长")])]),t._v(" "),a("p",[a("code",[t._v("Ref")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://segmentfault.com/a/1190000018130499",target:"_blank",rel:"noopener noreferrer"}},[t._v("css加载会造成阻塞吗"),a("OutboundLink")],1)])]),t._v(" "),a("h5",{attrs:{id:"图片的加载不会阻塞dom渲染过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#图片的加载不会阻塞dom渲染过程"}},[t._v("#")]),t._v(" 图片的加载不会阻塞DOM渲染过程")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("111")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("img src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test.png"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//图片的加载不会阻塞DOM渲染过程")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("222")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h4",{attrs:{id:"window-onload-和-domcontentloaded的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#window-onload-和-domcontentloaded的区别"}},[t._v("#")]),t._v(" "),a("code",[t._v("window.onload")]),t._v(" 和 "),a("code",[t._v("DOMContentLoaded")]),t._v("的区别")]),t._v(" "),a("ul",[a("li",[t._v("建议使用"),a("code",[t._v("document.addEventListener('DOMContentLoaded', fn(){...})")])])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'load'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 页面的全部资源加载完成后才会执行，包括图片、视频等")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ndocument"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DOMContentLoaded'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// DOM 渲染完成即可执行，此时图片、视频可能还没有加载完")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("h4",{attrs:{id:"什么是回流-什么是重绘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是回流-什么是重绘"}},[t._v("#")]),t._v(" 什么是回流 什么是重绘？")]),t._v(" "),a("ul",[a("li",[t._v("回流"),a("code",[t._v("reflow")]),t._v("："),a("code",[t._v("render")]),t._v("树中一部分或全部元素需要改变尺寸、布局、或着需要隐藏而需要重新构建")]),t._v(" "),a("li",[t._v("重绘"),a("code",[t._v("repaint")]),t._v("："),a("code",[t._v("render")]),t._v("树中一部分元素改变，而不影响布局的，只影响外观的，比如颜色")]),t._v(" "),a("li",[t._v("回流必将引起重绘")])]),t._v(" "),a("h5",{attrs:{id:"优化方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化方案"}},[t._v("#")]),t._v(" 优化方案")]),t._v(" "),a("ul",[a("li",[t._v("缓存DOM操作    多次DOM变成插入一个"),a("code",[t._v("createDocumentFragment")])]),t._v(" "),a("li",[t._v("使用"),a("code",[t._v("window.requestAnimationFrame()")]),t._v("，因为它可以把代码推迟到下一次重绘之前执行，而不是立即要求页面重绘。")]),t._v(" "),a("li",[t._v("使用虚拟DOM")])]),t._v(" "),a("h5",{attrs:{id:"raf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#raf"}},[t._v("#")]),t._v(" RAF")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[a("code",[t._v("window.requestAnimationFrame()")])]),t._v(" 告诉浏览器：你希望执行一个动画，并且要求浏览器在下次重绘之前调用指定的回调函数更新动画。")])]),t._v(" "),a("li",[a("p",[t._v("要想动画流畅，更新频率要60帧/s，即16.67ms更新一次视图")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("setTimeout")]),t._v(" 要手动控制频率，而RAF浏览器会自动控制")])])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("后台标签或者隐藏在iframe中， "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RAF")]),t._v(" 会暂停，而setTimeout 依然执行\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3s 把宽度 从100px -> 640px 增加 540px")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 60帧/s 3s 180帧 每次变化 3px")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 而且当页面切换的时候会暂停执行")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" div1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" curWidth "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" maxWidth "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("640")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// setTimeout")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("animate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  curWidth "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" curWidth "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n  div1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("width "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" curWidth "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'px'")]),t._v("\n\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("curWidth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" div1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("width"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("curWidth "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" maxWidth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("animate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16.7")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里的animate 没加括号")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RAF")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("animate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  curWidth "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" curWidth "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n  div1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("width "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" curWidth "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'px'")]),t._v("\n\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("curWidth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" div1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("width"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("curWidth "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" maxWidth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestAnimationFrame")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("animate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 时间不用自己控制")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("animate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br")])]),a("h4",{attrs:{id:"js脚本的异步加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#js脚本的异步加载"}},[t._v("#")]),t._v(" JS脚本的异步加载")]),t._v(" "),a("p",[a("code",[t._v("Ref")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://wangdoc.com/javascript/bom/engine.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("浏览器环境概述"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("如何使"),a("code",[t._v("JS")]),t._v("文件在顶部仍然稍后加载呢？")]),t._v(" "),a("p",[t._v("常应用在引用了广告和统计的页面中，不会影响、堵塞，更不会影响到到页面其他元素")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("使用"),a("code",[t._v("defer")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v('<script src="a.js" defer><\/script>')])]),t._v(" "),a("li",[a("code",[t._v("defer")]),t._v("的作用是延迟脚本的执行，等到 DOM 加载生成后，再执行脚本")]),t._v(" "),a("li",[t._v("浏览器发现带有"),a("code",[t._v("defer")]),t._v("属性的"),a("code",[t._v("script")]),t._v("会继续往下解析 HTML 网页，同时并行下载"),a("code",[t._v("script")]),t._v("的外部脚本，等待网页解析完成再去执行脚本")])])]),t._v(" "),a("li",[a("p",[t._v("使用"),a("code",[t._v("async")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v('<script src="a.js" async><\/script>')])]),t._v(" "),a("li",[a("code",[t._v("async")]),t._v("的作用是使用另一个进程下载脚本，下载时不会阻塞渲染")]),t._v(" "),a("li",[t._v("浏览器发现带有"),a("code",[t._v("async")]),t._v("属性的"),a("code",[t._v("script")]),t._v("会继续往下解析 HTML 网页，同时并行下载"),a("code",[t._v("script")]),t._v("的外部脚本。当脚本下载完成会暂停HTML解析，先去执行脚本，执行完再来解析HTML。  这与"),a("code",[t._v("defer")]),t._v("有点差异")]),t._v(" "),a("li",[a("code",[t._v("async")]),t._v("会无视脚本顺序，优先执行先下载完成的")]),t._v(" "),a("li",[t._v("当同时存在"),a("code",[t._v("defer async")]),t._v("的时候 "),a("code",[t._v("defer")]),t._v("将会失效")])])]),t._v(" "),a("li",[a("p",[t._v("动态插入 "),a("code",[t._v("script")]),t._v(" 标签")]),t._v(" "),a("ul",[a("li",[t._v("动态生成的"),a("code",[t._v("script")]),t._v("标签不会阻塞页面渲染，但无法保证脚本的执行顺序")])])])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'b.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" script "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'script'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  script"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" src"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("ul",[a("li",[t._v("通过 "),a("code",[t._v("ajax")]),t._v(" 去获取 js 代码，然后通过 eval 执行")]),t._v(" "),a("li",[t._v("创建并插入 "),a("code",[t._v("iframe")]),t._v("，让它异步执行 js")])]),t._v(" "),a("p",[a("code",[t._v("Ref:")]),t._v(" "),a("a",{attrs:{href:"https://juejin.cn/post/6844903661139656718",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("JS脚本异步加载浅析")]),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"性能优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#性能优化"}},[t._v("#")]),t._v(" 性能优化")]),t._v(" "),a("p",[a("code",[t._v("Ref")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://juejin.cn/post/6844904031240863758",target:"_blank",rel:"noopener noreferrer"}},[t._v("2020年了,再不会webpack敲得代码就不香了(近万字实战)"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://juejin.cn/post/6854573213171580941",target:"_blank",rel:"noopener noreferrer"}},[t._v("你可能不知道的9条Webpack优化策略"),a("OutboundLink")],1)])]),t._v(" "),a("h4",{attrs:{id:"性能优化原则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#性能优化原则"}},[t._v("#")]),t._v(" 性能优化原则")]),t._v(" "),a("ul",[a("li",[t._v("多使用内存、缓存或其他方法")]),t._v(" "),a("li",[t._v("减少CPU计算量，减少网络请求，减少网络加载耗时")]),t._v(" "),a("li",[t._v("空间换时间")])]),t._v(" "),a("h4",{attrs:{id:"从何入手"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从何入手"}},[t._v("#")]),t._v(" 从何入手")]),t._v(" "),a("h5",{attrs:{id:"让加载更快"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#让加载更快"}},[t._v("#")]),t._v(" 让加载更快")]),t._v(" "),a("ul",[a("li",[t._v("减少资源体积：压缩代码")]),t._v(" "),a("li",[t._v("减少访问次数：合并代码，SSR服务器端渲染，缓存")]),t._v(" "),a("li",[t._v("使用更快的网络： CDN")])]),t._v(" "),a("h5",{attrs:{id:"让渲染更快"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#让渲染更快"}},[t._v("#")]),t._v(" 让渲染更快")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("CSS")]),t._v(" 放在"),a("code",[t._v("head")]),t._v(" ，"),a("code",[t._v("JS")]),t._v("放在"),a("code",[t._v("body")]),t._v("最下面")]),t._v(" "),a("li",[t._v("尽早开始执行"),a("code",[t._v("JS")]),t._v("，用"),a("code",[t._v("DOMContentLoaded")])]),t._v(" "),a("li",[t._v("触发懒加载（图片懒加载，上滑加载更多）")]),t._v(" "),a("li",[t._v("对DOM查询进行缓存")]),t._v(" "),a("li",[t._v("频繁DOM操作，合并到一起插入 DOM结构")]),t._v(" "),a("li",[t._v("节流"),a("code",[t._v("throttle")]),t._v("防抖"),a("code",[t._v("debounce")])])]),t._v(" "),a("h4",{attrs:{id:"实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例"}},[t._v("#")]),t._v(" 实例")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("资源合并 ==> 请求三次3kb 和请求一次9kb \t3次网络请求--\x3e 1次")])]),t._v(" "),a("li",[a("p",[t._v("缓存 ==> webpack 生成的"),a("code",[t._v("bundle.[contenthash].js")])]),t._v(" "),a("ul",[a("li",[t._v("如果生成的内容没有发生变化即哈希值没有发生改变 则不需要重新进行请求")]),t._v(" "),a("li",[t._v("静态资源加"),a("code",[t._v("hash")]),t._v("后缀，根据文件内容计算"),a("code",[t._v("hash")]),t._v("。如果文件内容不变，则"),a("code",[t._v("hash")]),t._v("不变，则"),a("code",[t._v("url")]),t._v("不变。既然url和文件不变，则会自动触发HTTP缓存机制，返回304")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("CDN")]),t._v(" ==> 根据地域做网络服务。静态文件 满足304机制")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("SSR")]),t._v(" ==> 服务器端渲染：网页和数据一起加载，一起渲染")])]),t._v(" "),a("li",[a("p",[t._v("非 "),a("code",[t._v("SSR")]),t._v(" ==> （前后端分离）：先加载网页，再加载数据，再渲染数据 (早先的"),a("code",[t._v("JSP ASP PHP")]),t._v(" ，现在的"),a("code",[t._v("vue React")])])]),t._v(" "),a("li",[a("p",[t._v("懒加载")]),t._v(" "),a("ul",[a("li",[t._v("加载"),a("code",[t._v("loading")]),t._v("图片")]),t._v(" "),a("li",[t._v("判断哪些图片要加载")]),t._v(" "),a("li",[t._v("隐形加载图片")]),t._v(" "),a("li",[t._v("替换真图片")])])])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 一张图片就是一个`<img>`标签，浏览器是否发起请求图片是根据`<img>`的`src`属性，所以实现懒加载的关键就是，在图片没有进入可视区域时，先不给`<img>`的`src`赋值，这样浏览器就不会发送请求了，等到图片进入可视区域再给`src`赋值")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 可以给img标签统-自定义属性data=src='default.png'，当检测到图片出现在窗口之后再补充src属性，此时才会进行图片资源加载")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lazyload")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" imgs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementsByTagName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'img'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" len "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" imgs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 视口高度")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" viewHeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("documentElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clientHeight\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//滚动务高度")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" scrollHeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n    document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("documentElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scrolltop "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scrollTop\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" offsetHeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" imgs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetTop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("offsetHeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" viewHeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" scrollHeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" imgs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dataset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src\n      imgs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" src\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//可以使用节流优化一下")]),t._v("\nwindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventlListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'scroll'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lazyload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br")])]),a("p",[a("code",[t._v("Ref")]),t._v("："),a("a",{attrs:{href:"https://blog.csdn.net/w1418899532/article/details/90515969",target:"_blank",rel:"noopener noreferrer"}},[t._v("js实现图片懒加载原理"),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[t._v("缓存DOM查询")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不缓存 DOM 查询结果")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementsByTagName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 每次循环 都会计算length 频繁进行DOM查询")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 缓存 DOM 查询结果")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" pList "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementsByTagName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 缓存length 只进行一次 DOM 查询")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("ul",[a("li",[t._v("多个DOM操作一起插入到DOM结构：\n"),a("ul",[a("li",[a("code",[t._v("document.createDocumentFragment()")])])])]),t._v(" "),a("li",[t._v("尽早开始"),a("code",[t._v("JS")]),t._v("执行")]),t._v(" "),a("li",[a("code",[t._v("document.addEventListener('DOMContentLoaded', function () {}")])]),t._v(" "),a("li",[t._v("防抖节流")])]),t._v(" "),a("h5",{attrs:{id:"首屏优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#首屏优化"}},[t._v("#")]),t._v(" 首屏优化")]),t._v(" "),a("ul",[a("li",[t._v("尽可能的缩小webpack或者其他打包工具生成的包的大小")]),t._v(" "),a("li",[t._v("路由懒加载")]),t._v(" "),a("li",[t._v("组件按需加载")]),t._v(" "),a("li",[t._v("图片懒加载")]),t._v(" "),a("li",[t._v("服务端渲染SSR")]),t._v(" "),a("li",[t._v("gzip")])]),t._v(" "),a("h5",{attrs:{id:"csr-ssr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csr-ssr"}},[t._v("#")]),t._v(" CSR SSR")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("CSR")]),t._v(" 客户端渲染")]),t._v(" "),a("li",[a("code",[t._v("SSR")]),t._v(" 服务端渲染\n"),a("ul",[a("li",[t._v("由服务端把渲染的完整的页面返回给客户端，减少了一次客户端到服务端的一次http请求")]),t._v(" "),a("li",[t._v("返回完整页面 就利于SEO优化")]),t._v(" "),a("li",[t._v("SSR强在首屏渲染。而CSR强在用户和页面多交互的场景")])])])]),t._v(" "),a("h2",{attrs:{id:"安全"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安全"}},[t._v("#")]),t._v(" 安全")]),t._v(" "),a("h4",{attrs:{id:"xss-跨站脚本攻击"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xss-跨站脚本攻击"}},[t._v("#")]),t._v(" "),a("code",[t._v("XSS")]),t._v(" 跨站脚本攻击")]),t._v(" "),a("h5",{attrs:{id:"攻击"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#攻击"}},[t._v("#")]),t._v(" 攻击")]),t._v(" "),a("blockquote",[a("p",[t._v("反射型"),a("code",[t._v("XSS")])])]),t._v(" "),a("ul",[a("li",[t._v("反射型"),a("code",[t._v("XSS")]),t._v("，非持久化，需要欺骗用户自己去点击链接才能触发"),a("code",[t._v("XSS")]),t._v("代码（服务器中没有这样的页面和内容），一般容易出现在搜索页面。")])]),t._v(" "),a("blockquote",[a("p",[t._v("存储型"),a("code",[t._v("XSS")])])]),t._v(" "),a("p",[t._v("一个博客网站，我发表一篇博客，其中嵌入"),a("code",[t._v("<script>")]),t._v("脚本，脚本内容：获取"),a("code",[t._v("cookie")]),t._v("，发送到我的服务器（服务器配合跨域）。发布这篇博客，有人查看它，我轻松收割访问者的"),a("code",[t._v("cookie")]),t._v("。")]),t._v(" "),a("h5",{attrs:{id:"预防"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#预防"}},[t._v("#")]),t._v(" 预防")]),t._v(" "),a("blockquote",[a("p",[t._v("转译字符")])]),t._v(" "),a("ul",[a("li",[t._v("前端要替换，后端也要替换，都做总不会有错")]),t._v(" "),a("li",[a("code",[t._v("https://www.npmjs.com/package/xss")])])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("escape")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("str")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  str "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&amp;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  str "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&lt;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  str "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&gt;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  str "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v('"')]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&quto;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  str "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("'")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&#39;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  str "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&#96;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  str "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\/")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&#x2F;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" str\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br")])]),a("blockquote",[a("p",[a("code",[t._v("HttpOnly")])])]),t._v(" "),a("ul",[a("li",[t._v("禁止通过"),a("code",[t._v("document.cookie")]),t._v("的方式获取"),a("code",[t._v("cookies")])])]),t._v(" "),a("blockquote",[a("p",[t._v("设置白名单或者黑名单")])]),t._v(" "),a("ul",[a("li",[t._v("对于富文本编辑器 建议使用 白名单")])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("csp")])])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Content Security Policy")]),t._v("  内容安全策略")]),t._v(" "),a("li",[t._v("实质：白名单制度，开发者明确告诉客户端，哪些外部资源可以加载和执行")])]),t._v(" "),a("p",[t._v("如何启用"),a("code",[t._v("CSP")])]),t._v(" "),a("ul",[a("li",[t._v("通过 HTTP 头信息的"),a("code",[t._v("Content-Security-Policy")]),t._v("的字段")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Content"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Security"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Policy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'self'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" object"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'none'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nstyle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src cdn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org third"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("party"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" child"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src https"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("ul",[a("li",[t._v("通过网页的"),a("code",[t._v("<meta>")]),t._v("标签")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("meta http"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("equiv"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-Security-Policy"')]),t._v(" content"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"script-src 'self'; object-src 'none'; style-src cdn.example.org third-party.org; child-src https:\"")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("ul",[a("li",[t._v("如上设置\n"),a("ul",[a("li",[t._v("脚本：只信任当前域名")]),t._v(" "),a("li",[a("code",[t._v("<object>")]),t._v("标签：不信任任何URL，即不加载任何资源")]),t._v(" "),a("li",[t._v("样式表：只信任"),a("code",[t._v("cdn.example.org")]),t._v("和"),a("code",[t._v("third-party.org")])]),t._v(" "),a("li",[t._v("框架 "),a("code",[t._v("(frame)")]),t._v("：必须使用"),a("code",[t._v("HTTPS")]),t._v("协议加载")]),t._v(" "),a("li",[t._v("其他资源：没有限制")])])])]),t._v(" "),a("h4",{attrs:{id:"csrf-跨站请求伪造"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csrf-跨站请求伪造"}},[t._v("#")]),t._v(" "),a("code",[t._v("CSRF")]),t._v(" 跨站请求伪造")]),t._v(" "),a("h5",{attrs:{id:"攻击-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#攻击-2"}},[t._v("#")]),t._v(" 攻击")]),t._v(" "),a("p",[t._v("原理： 诱导用户打开黑客的网站，在黑客的网站中，利用用户登录状态发起跨站点请求。")]),t._v(" "),a("ol",[a("li",[t._v("浏览器向网站A发起通信请求")]),t._v(" "),a("li",[t._v("网站A验证通过，建立了通信连接，在浏览器存了A的cookie")]),t._v(" "),a("li",[t._v("浏览器在未关闭A的连接下访问网站B")]),t._v(" "),a("li",[t._v("网站B含有恶意请求代码，向网站A发起请求")]),t._v(" "),a("li",[t._v("浏览器根据B发起的请求并且携带A的cookie访问A")]),t._v(" "),a("li",[t._v("网站A验证cookie并且响应了这个请求")])]),t._v(" "),a("p",[t._v("网站B就通过盗用保存在客户端的cookie，以客户端的身份来访问网站A，以客户端身份进行一些非法操作。")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("你正在购物，看中了某个商品，商品id是"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n付费接口是xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("pay"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("，但没有任何验证\n我是攻击者，我看中了一个商品，id是"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v("\n\n我向你发送一封电子邮件，邮件标题很吸引人\n但邮件正文隐藏着"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("img src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("pay"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n你一查看邮件，就帮我购买了id是"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v("的商品\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("h5",{attrs:{id:"预防-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#预防-2"}},[t._v("#")]),t._v(" 预防")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("SameSite")])])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("对 "),a("code",[t._v("Cookie")]),t._v(" 设置 "),a("code",[t._v("SameSite")]),t._v(" 属性。表示 "),a("code",[t._v("Cookie")]),t._v(" 不随着跨域请求发送，可以很大程度减少 "),a("code",[t._v("CSRF")]),t._v(" 的攻击，但是存在兼容性问题。")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("Strict")]),t._v("：所有从当前域发送出来的非同域请求都不会带上"),a("code",[t._v("cookie")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("Lax")]),t._v("：就是在GET方式提交表单时会携带"),a("code",[t._v("cookie，post、iframe/img")]),t._v("等标签加载时不会携带"),a("code",[t._v("cookie")]),t._v("。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("None")]),t._v("：关闭"),a("code",[t._v("SameSite")]),t._v("，不过，前提是必须同时设置"),a("code",[t._v("Secure")]),t._v("属性"),a("code",[t._v("(Cookie 只能通过 HTTPS 协议发送)")]),t._v("，否则无效。")])])])])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Set"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Cookie"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" CookieName"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("CookieValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" SameSite"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Strict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//这个规则过于严格，可能造成非常不好的用户体验。")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//比如，当前网页有一个 GitHub 链接，用户点击跳转就不会带有 GitHub 的 Cookie，跳转过去总是未登陆状态。")]),t._v("\n\nSet"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Cookie"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" CookieName"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("CookieValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" SameSite"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Lax"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Lax规则稍稍放宽，大多数情况也是不发送第三方 Cookie，但是导航到目标网址的 Get 请求除外。")]),t._v("\n\nSet"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Cookie"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" widget_session"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("abc123"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" SameSite"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("None"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Secure\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("blockquote",[a("p",[t._v("验证 "),a("code",[t._v("HTTP Referer")]),t._v(" 字段")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("HTTP Referer")]),t._v("是"),a("code",[t._v("header")]),t._v("的一部分，当浏览器向web服务器发送请求时，一般会带上"),a("code",[t._v("Referer")]),t._v("信息告诉服务器是从哪个页面链接过来的，服务器籍此可以获得一些信息用于处理。可以通过检查请求的来源来防御"),a("code",[t._v("CSRF")]),t._v("攻击。正常请求的"),a("code",[t._v("referer")]),t._v("具有一定规律，如在提交表单的"),a("code",[t._v("referer")]),t._v("必定是在该页面发起的请求。所以通过检查"),a("code",[t._v("http")]),t._v("包头"),a("code",[t._v("referer")]),t._v("的值是不是这个页面，来判断是不是"),a("code",[t._v("CSRF")]),t._v("攻击。")]),t._v(" "),a("li",[a("code",[t._v("Refer")]),t._v(" 可能被伪造")])]),t._v(" "),a("blockquote",[a("p",[t._v("在请求地址中添加 "),a("code",[t._v("token")]),t._v(" 并验证")])]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("token")]),t._v(" 请求拦截 验证是否合法")])]),t._v(" "),a("li",[a("p",[t._v("使用 "),a("code",[t._v("post")]),t._v(" 接口")])]),t._v(" "),a("li",[a("p",[t._v("增加验证，例如密码、短信验证码、指纹等")])])]),t._v(" "),a("h4",{attrs:{id:"sql-注入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sql-注入"}},[t._v("#")]),t._v(" "),a("code",[t._v("sql")]),t._v(" 注入")]),t._v(" "),a("blockquote",[a("p",[t._v("权限最小化")])]),t._v(" "),a("ul",[a("li",[t._v("严格限制Web应用的数据库的操作权限，给此用户提供仅仅能够满足其工作的最低权限，从而最大限度的减少注入攻击对数据库的危害。")])]),t._v(" "),a("blockquote",[a("p",[t._v("正则匹配 字符转义")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("const reg = /select|update|delete|exec|count|'|\"|=|;|>|<|%/i;")])])]),t._v(" "),a("h4",{attrs:{id:"点击劫持"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#点击劫持"}},[t._v("#")]),t._v(" 点击劫持")]),t._v(" "),a("ul",[a("li",[t._v("通过覆盖不可见的框架误导受害者点击\n"),a("ul",[a("li",[t._v("使用一个透明的"),a("code",[t._v("iframe")]),t._v("，覆盖在一个网页上，诱使用户在该页面上进行操作")]),t._v(" "),a("li",[t._v("使用一张图片覆盖在网页，遮挡网页原有位置的含义")])])])]),t._v(" "),a("p",[t._v("使用HTTP头  "),a("code",[t._v("X-Frame-Options")]),t._v(" 进行攻击防御这个")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("deny")]),t._v("：表示该页面不允许在 "),a("code",[t._v("frame")]),t._v(" 中展示，即便是在相同域名的页面中嵌套也不允许")]),t._v(" "),a("li",[a("code",[t._v("sameorigin")]),t._v("：表示该页面可以在相同域名页面的 "),a("code",[t._v("frame")]),t._v(" 中展示")]),t._v(" "),a("li",[a("code",[t._v("allow-form url")]),t._v("：表示该页面可以在指定来源的 "),a("code",[t._v("frame")]),t._v(" 中展示")])]),t._v(" "),a("p",[a("code",[t._v("Ref")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/83865185",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端安全"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2016/09/csp.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Content Security Policy 入门教程"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://juejin.cn/post/6951571103953190925",target:"_blank",rel:"noopener noreferrer"}},[t._v("一、web安全（xss/csrf）简单攻击原理和防御方案（理论篇）"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=n.exports}}]);